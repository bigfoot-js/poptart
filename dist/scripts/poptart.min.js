(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y;o=require("bigfoot-obj"),k=require("bigfoot-dom"),b="data-poptart-max-width",a="data-poptart-max-height",c={BOTTOM:"bottom",TOP:"top"},u={},e={},s=void 0,y=function(c,d){var f,g,i;return g=d.callback(c),f=document.createElement("div"),f.innerHTML=g,i=f.firstChild,setTimeout(function(){var f;return f=window.getComputedStyle(i),setTimeout(function(){return i.setAttribute(b,h(f.maxWidth)),i.setAttribute(a,h(f.maxHeight)),i.style.maxWidth="none",s=r(d),s(),i.classList.add(d.activeClass)},0),e.popover=i,e.source=c,c.parentNode.appendChild(i),window.addEventListener("resize",s),window.addEventListener("scroll",s)},0),i},v=function(){var a,b,c;if(e.popover)return a=e.popover,c=function(){var b;return null!=(b=a.parentNode)?b.removeChild(a):void 0},a.addEventListener("transitionend",c),a.addEventListener("webkitTransitionend",c),a.classList.remove("is-active"),e={},b=void 0,window.removeEventListener("resize",s),window.removeEventListener("scroll",s)},l=function(a,b){if(!b)return!1;for(;a!==document.body;){if(a===b)return!0;a=a.parentNode}return!1},m=function(a){return l(a,e.popover)},n=function(a){return l(a,e.source)},j=function(a){var b,c;return c=!n(a.target),e.popover&&!m(a.target)&&v(),c?(b=Popover.triggerPopoverFor(a.target),!!b):void 0},f=function(a){var b,c,d,e,f,g;return c=a.getBoundingClientRect(),g=[c.top+.5*c.height,c.left+.5*c.width],e=g[0],b=g[1],d={height:c.height,width:c.width},f={height:window.innerHeight,width:window.innerWidth},{top:e,bottom:f.height-e,left:b,leftRelative:b/f.width,right:f.width-b,window:f,source:d}},g=function(){var a,b;return a=document.createElement("div"),a.style.cssText="display:inline-block;padding:0;line-height:1;position:absolute;visibility:hidden;font-size:1em;",a.appendChild(document.createElement("M")),document.body.appendChild(a),b=a.offsetHeight,document.body.removeChild(a),b},h=function(a,b){return i(a,b)||1e4},i=function(a,b,c){return null==c&&(c=!0),"none"===a?0:a.indexOf("rem")>=0?parseFloat(a)*g():a.indexOf("em")>=0?parseFloat(a)*parseFloat(window.getComputedStyle(b).fontSize):a.indexOf("%")>=0||a.indexOf("vw")>=0?parseFloat(a)/100:(a=parseFloat(a),60>=a&&c&&(a/=parseFloat(b.parentNode.offsetWidth)),a)},p=function(a){return a===c.BOTTOM?c.TOP:c.BOTTOM},x=function(a){var c,d,f;return c=parseFloat(e.popover.getAttribute(b)),f=k.find(e.popover,".bigfoot-footnote__wrapper"),1>=c&&(d=function(){var b,c;return c=1e4,a&&(b=k.one(a),b&&(c=b.offsetWidth)),Math.min(window.innerWidth,c)}(),c=d*c),c=Math.min(c,k.find(e.popover,".bigfoot-footnote__content").offsetWidth+1),f.style.maxWidth=""+c+"px"},w=function(b,d){var f,g,h,j,l,m,n,o;return h=parseFloat(e.popover.getAttribute(a)),l=e.popover,n=window.getComputedStyle(l),g=i(n.marginTop,l,!1)+i(n.marginBottom,l,!1),m=l.offsetHeight+g,j=p(d),b[d]<m&&b[d]<b[j]&&(d=j),o=""+100*b.leftRelative+"% top 0",d===c.TOP?(l.classList.add("is-positioned-top"),l.classList.remove("is-positioned-bottom"),h=Math.min(h,b.top-g),o=""+100*b.leftRelative+"% bottom 0"):(l.classList.add("is-positioned-bottom"),l.classList.remove("is-positioned-top"),h=Math.min(h,b.bottom-g)),l.style.transformOrigin=o,f=k.find(l,".bigfoot-footnote__content"),f.style.maxHeight=""+h+"px"},t=function(a,b){var c;return c=k.find(e.popover,".bigfoot-footnote__tooltip"),c?c.style.left=""+(b.offsetWidth*a.leftRelative+2)+"px":void 0},r=function(a){return function(b){var c,d,g,h,j,k;return j=(null!=b?b.type:void 0)||"resize",a.positionPopovers&&e.popover?(k=[e.popover,e.source],c=k[0],d=k[1],g=window.getComputedStyle(d),h=f(d),w(h,a.preferredPosition),"resize"===j&&x(a.maxWidthRelativeTo),t(h,c),c.style.marginLeft=""+(-1*h.leftRelative*c.offsetWidth+h.source.width/2+i(g.marginLeft,d))+"px"):void 0}},q={preferredPosition:c.BOTTOM,positionPopovers:!0,debounce:!1,preventPageScroll:!0,activeClass:"is-active",inactiveClass:"popover--is-inactive"},d=function(){function a(){}return a.POSITIONS=c,a.registerPopover=function(a,b){var c;return"function"==typeof b?b={callback:b}:b.callback=b,c=o.merge(o.clone(q),b),u[a]=c},a.triggerPopoverFor=function(a){var b,c,d;d=void 0;for(b in u)if(c=u[b],event.target.webkitMatchesSelector(b)){d=c;break}return d?y(a,d):void 0},a}(),document.addEventListener("click",j),document.addEventListener("touchend",j),module.exports=d}).call(this);